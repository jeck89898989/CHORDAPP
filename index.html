<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guitar Chord Progression Hub</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <header>
            <h1>Guitar Chord Progression Hub</h1>
            <nav>
                <a href="chord-library.html" class="nav-link">Chord Diagram Library</a>
            </nav>
            <div class="controls">
                <select id="keySelect">
                    <option value="C">C</option>
                    <option value="C#">C#</option>
                    <option value="D">D</option>
                    <option value="D#">D#</option>
                    <option value="E">E</option>
                    <option value="F">F</option>
                    <option value="F#">F#</option>
                    <option value="G">G</option>
                    <option value="G#">G#</option>
                    <option value="A">A</option>
                    <option value="A#">A#</option>
                    <option value="B">B</option>
                </select>
                <select id="categorySelect">
                    <option value="">All Categories</option>
                </select>
                <select id="strummingSelect">
                    <option value="">Select Strumming Pattern</option>
                </select>
                <select id="pickingSelect">
                    <option value="">Select Picking Pattern</option>
                </select>
                <input type="text" id="searchInput" placeholder="Search progressions...">
                <button id="exportBtn">Export CSV</button>
                <input type="file" id="importFile" accept=".csv" style="display: none;">
                <button id="importBtn">Import CSV</button>
            </div>
        </header>

        <main>
            <div class="content-grid">
                <div class="progression-list collapsible">
                    <h2>Progressions <button class="close-section-btn" id="closeProgressionsBtn" title="Close Progressions section">×</button></h2>
                    <div class="collapsible-content">
                        <div class="progression-controls">
                            <div class="view-options">
                                <button id="groupedViewBtn" class="active">Grouped</button>
                                <button id="listViewBtn">List</button>
                            </div>
                            <div class="sort-options">
                                <label for="sortSelect">Sort by:</label>
                                <select id="sortSelect">
                                    <option value="name">Name</option>
                                    <option value="category">Category</option>
                                </select>
                            </div>
                        </div>
                        <div id="progressionContainer"></div>
                    </div>
                </div>

                <div class="progression-details">
                    <button id="backToListBtn">← Back to List</button>
                    <div class="progression-header">
                        <h2 id="currentProgressionName">Select a progression</h2>
                        <div class="transpose-controls">
                            <label for="transposeKeySelect">Transpose to:</label>
                            <select id="transposeKeySelect">
                                <option value="C">C</option>
                                <option value="C#">C#</option>
                                <option value="D">D</option>
                                <option value="D#">D#</option>
                                <option value="E">E</option>
                                <option value="F">F</option>
                                <option value="F#">F#</option>
                                <option value="G">G</option>
                                <option value="G#">G#</option>
                                <option value="A">A</option>
                                <option value="A#">A#</option>
                                <option value="B">B</option>
                            </select>
                        </div>
                        <div class="view-toggles">
                            <button id="chordsToggle" class="active">Chords</button>
                            <button id="romanToggle">Roman</button>
                            <button id="intervalsToggle">Intervals</button>
                        </div>
                    </div>

                    <div id="progressionDisplay" class="progression-display">
                        <p>Choose a progression from the left to see details</p>
                    </div>

                    <div class="chord-editor collapsible">
                        <h3>Edit Progression <button class="delete-section-btn" id="deleteEditBtn" title="Delete Edit Progression section">×</button></h3>
                        <div class="collapsible-content">
                            <div class="chord-input-section">
                                <input type="text" id="chordInput" placeholder="Add chord (e.g., Am, F7, Gsus4)">
                                <button id="addChordBtn">Add Chord</button>
                                <button id="clearProgressionBtn">Clear All</button>
                                <input type="file" id="importProgressionFile" accept=".csv" style="display: none;">
                                <button id="importProgressionBtn">Import This Progression</button>
                                <button id="exportProgressionBtn">Export This Progression</button>
                                <button id="exportAllChordsBtn">Export All Chords</button>
                                <input type="file" id="importChordsFile" accept=".csv" style="display: none;">
                                <button id="importChordsBtn">Import Chords CSV</button>
                            </div>
                            <div id="customChordsList"></div>
                        </div>
                    </div>

                    <div class="chord-diagrams collapsible">
                        <h3>Chord Diagrams <button class="close-section-btn" id="closeChordDiagramsBtn" title="Close Chord Diagrams section">×</button></h3>
                        <div class="collapsible-content">
                            <div id="diagramsContainer"></div>
                        </div>
                    </div>
                    
                    <div class="chord-playback collapsible">
                        <h3>Chord Playback</h3>
                        <div class="collapsible-content">
                            <div class="playback-controls">
                                <button id="playProgressionBtn">Play Progression</button>
                                <button id="stopProgressionBtn" style="display: none;">Stop</button>
                                <label for="playbackTempo">Tempo (BPM):</label>
                                <input type="number" id="playbackTempo" value="120" min="60" max="200">
                                <label for="chordDuration">Chord Duration (beats):</label>
                                <input type="number" id="chordDuration" value="4" min="1" max="8">
                            </div>
                            <div id="playbackStatus">Select a progression to play</div>
                        </div>
                    </div>
                    
                    <div class="strumming-section collapsible">
                        <h3>Strumming Pattern <button class="delete-section-btn" id="deleteStrummingBtn" title="Delete Strumming Pattern section">×</button></h3>
                        <div class="collapsible-content">
                            <div class="pattern-controls">
                                <label for="strummingSectionSelect">Select Pattern:</label>
                                <select id="strummingSectionSelect">
                                    <option value="">Select Strumming Pattern</option>
                                </select>
                            </div>
                            <div class="pattern-actions">
                                <button id="exportStrummingBtn">Export Strumming CSV</button>
                                <input type="file" id="importStrummingFile" accept=".csv" style="display: none;">
                                <button id="importStrummingBtn">Import Strumming CSV</button>
                            </div>
                            <div id="strummingDisplay"></div>
                        </div>
                    </div>
                    <div class="picking-section collapsible">
                        <h3>Picking Pattern <button class="delete-section-btn" id="deletePickingBtn" title="Delete Picking Pattern section">×</button></h3>
                        <div class="collapsible-content">
                            <div class="pattern-controls">
                                <label for="pickingSectionSelect">Select Pattern:</label>
                                <select id="pickingSectionSelect">
                                    <option value="">Select Picking Pattern</option>
                                </select>
                            </div>
                            <div class="pattern-actions">
                                <button id="exportPickingBtn">Export Picking CSV</button>
                                <input type="file" id="importPickingFile" accept=".csv" style="display: none;">
                                <button id="importPickingBtn">Import Picking CSV</button>
                            </div>
                            <div id="pickingDisplay"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="recording-section collapsible">
                <h2>Record Audio & Video <button class="close-section-btn" id="closeRecordingBtn" title="Close Recording section">×</button></h2>
                <div class="collapsible-content">
                    <div class="recording-tabs">
                        <button id="audioTabBtn" class="active">Audio</button>
                        <button id="videoTabBtn">Video</button>
                    </div>
                    
                    <div id="audioRecording" class="recording-tab active">
                        <div class="audio-controls">
                            <button id="recordBtn">Record</button>
                            <button id="stopBtn" disabled>Stop</button>
                            <button id="playBtn" disabled>Play</button>
                            <button id="saveBtn" disabled>Save MP3</button>
                        </div>
                        <div id="recordingStatus">Ready to record</div>
                        <audio id="audioPlayback" controls></audio>
                    </div>
                    
                    <div id="videoRecording" class="recording-tab">
                        <div class="video-controls">
                            <button id="recordVideoBtn">Record Video</button>
                            <button id="stopVideoBtn" disabled>Stop</button>
                            <button id="playVideoBtn" disabled>Play</button>
                            <button id="saveVideoBtn" disabled>Save MP4</button>
                        </div>
                        <div id="videoRecordingStatus">Ready to record video</div>
                        <video id="videoPreview" autoplay muted style="display: none; width: 100%; max-width: 400px; margin: 10px 0;"></video>
                        <video id="videoPlayback" controls style="display: none; width: 100%; max-width: 400px; margin: 10px 0;"></video>
                    </div>
                </div>
            </div>

            <div class="fretboard-explorer collapsible collapsed">
                <h2>Scale Explorer <button class="close-section-btn" id="closeScaleExplorerBtn" title="Close Scale Explorer section">×</button></h2>
                <div class="collapsible-content">
                    <div class="fretboard-controls">
                        <label for="fretboardKeySelect">Key:</label>
                        <select id="fretboardKeySelect">
                            <option value="C">C</option>
                            <option value="C#">C#</option>
                            <option value="D">D</option>
                            <option value="D#">D#</option>
                            <option value="E">E</option>
                            <option value="F">F</option>
                            <option value="F#">F#</option>
                            <option value="G">G</option>
                            <option value="G#">G#</option>
                            <option value="A">A</option>
                            <option value="A#">A#</option>
                            <option value="B">B</option>
                        </select>
                        <label for="fretboardScaleSelect">Scale/Chord:</label>
                        <select id="fretboardScaleSelect">
                            <!-- Options will be populated by JS -->
                        </select>
                        <label for="startFret">Start Fret:</label>
                        <input type="number" id="startFret" value="0" min="0" max="23">
                        <label for="endFret">End Fret:</label>
                        <input type="number" id="endFret" value="15" min="1" max="24">
                        <label for="cycleSeconds">Cycle Chords (s):</label>
                        <input type="number" id="cycleSeconds" value="30" min="1" max="300">
                    </div>
                    <div class="chord-cycle-controls">
                        <button id="playCycleBtn">Play Chord Cycle</button>
                        <button id="stopCycleBtn" style="display: none;">Stop Cycle</button>
                    </div>
                    <div class="fretboard-actions">
                        <button id="exportScalesBtn">Export Scales CSV</button>
                        <input type="file" id="importScalesFile" accept=".csv" style="display: none;">
                        <button id="importScalesBtn">Import Scales CSV</button>
                    </div>
                    <div id="fretboardContainer"></div>
                </div>
            </div>
        </main>
        
        <div class="reset-controls">
            <button id="resetSectionsBtn" class="reset-sections-btn">Reset All Sections</button>
        </div>
    </div>

    <script type="module" src="app.js"></script>
</body>
</html>